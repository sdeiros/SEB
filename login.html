<!DOCTYPE html>
<html>

<head>
  <title>Tela de Login</title>
</head>

<body>
  <form id="loginForm">
    <label for="usuario">Usuário:</label>
    <input type="text" id="usuario" name="usuario" required><br><br>
    <label for="senha">Senha:</label>
    <input type="password" id="senha" name="senha" required><br><br>
    <button type="button" onclick="realizarLogin()">Entrar</button>
    <button type="button" onclick="recuperarSenha()">Recuperar Senha</button>
  </form>
  <p id="mensagem"></p>

  <script>
    // Função para realizar o login
    function realizarLogin() {
      var usuario = document.getElementById("usuario").value; // Obtém o valor do campo de usuário
      var senha = document.getElementById("senha").value; // Obtém o valor do campo de senha

      // Fazer a requisição para a planilha usando a API do Google Sheets
      fetch('https://sheets.googleapis.com/v4/spreadsheets/1Bz1yFGSxaLlvo6MNsiRdqcgNpDf7YbUS358S7lAV1-Y/values/A:C?key=AIzaSyB7anIj9Q08ueFQVQ6aevLttAkzJNNAGXs')
        .then(response => response.json()) // Converter a resposta para JSON
        .then(data => {
          var rows = data.values; // Obter as linhas da planilha
          var loginSuccessful = false;

          // Verificar se as credenciais são válidas
          for (var i = 1; i < rows.length; i++) {
            var row = rows[i];
            var storedUsuarioA = row[0]; // A coluna A contém os usuários (alternativa 1)
            var storedUsuarioC = row[2]; // A coluna C contém os usuários (alternativa 2)
            var storedSenha = row[1]; // A coluna B contém as senhas na planilha

            if ((usuario === storedUsuarioA || usuario === storedUsuarioC) && senha === storedSenha) {
              loginSuccessful = true; // Defina a variável como verdadeira se as credenciais coincidirem
              break;
            }
          }

          if (loginSuccessful) {
            document.getElementById("mensagem").textContent = "Login bem-sucedido!";
            window.open("https://sites.google.com/view/testeiserj/index?authuser=0", "_blank"); // Redireciona para a página desejada no Google Sites
          } else {
            document.getElementById("mensagem").textContent = "Usuário ou senha incorretos!";
            window.open("https://sites.google.com/view/testeiserj/erro?authuser=0", "_blank"); // Redireciona para a página desejada no Google Sites
          }
        })
        .catch(error => {
          console.log("Erro ao acessar a planilha:", error);
        });
    }

    // Função para recuperar a senha
    function recuperarSenha() {
      window.open("https://sites.google.com/view/testeiserj/recuperar-senha?authuser=0", "_blank"); // Redireciona para a página de recuperação de senha no Google Sites
    }
  </script>
</body>

</html>
